(window.webpackJsonpminiapp=window.webpackJsonpminiapp||[]).push([[0],{196:function(e,t,n){e.exports=n(309)},287:function(e,t,n){},288:function(e,t,n){},289:function(e,t,n){},309:function(e,t,n){"use strict";n.r(t);n(197),n(223),n(225),n(226),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(235),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(259),n(260),n(261),n(262),n(263),n(264),n(265);var r=n(47),a=n(48),o=n(54),s=n(49),i=n(55),c=n(0),u=n.n(c),p=n(50),l=n.n(p),f=(n(273),n(274),n(15)),h=(n(287),n(288),n(289),n(8)),d=n.n(h),b=n(37),m=n(4),g=n.n(m),v=n(9),_=n(34),y=n(39);function k(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";this.back=Object(v.a)(g.a.mark((function t(){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===e.state.popout||void 0===e.state.popout){t.next=4;break}return e.setState({popout:null}),window.history.pushState({pop:"popout"},"Title"),t.abrupt("return");case 4:if(1!==(n=e.state.history).length){t.next=9;break}d.a.send("VKWebAppClose",{status:"success"}),t.next=13;break;case 9:if(!(n.length>1)){t.next=13;break}return n.pop(),t.next=13,e.setState({activePanel:n[n.length-1],history:n,snackbar:null});case 13:case"end":return t.stop()}}),t)}))),this.go=function(t){var n=e.state.history;"object"===typeof t&&t.currentTarget&&(t=t.currentTarget.dataset.to),n[n.length-1]!==t&&(n.push(t),window.history.pushState({activePanel:t},"Title"),e.setState({activePanel:t,history:n,snackbar:null}))},this.setActiveModal=function(t){e.setState({activeModal:t})},this.setActivePanel=function(t,n){e.setState({activePanel:t,history:n?[].concat(Object(y.a)(n),[t]):[t]})},this.setPopout=function(t){e.setState({popout:t})},this.setAlert=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[{title:"\u041e\u043a",autoclose:!0}];e.setPopout(u.a.createElement(f.b,{actions:r,actionsLayout:"vertical",onClose:function(){return e.setPopout(null)},header:t,text:n}))},this.state.history=[t],this.state.activePanel=t}function x(){return{activePanel:this.state.activePanel,onSwipeBack:this.back,history:this.state.history,popout:this.state.popout}}n(46),n(69);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(n,!0).forEach((function(t){Object(b.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e){return E.apply(this,arguments)}function E(){return(E=Object(v.a)(g.a.mark((function e(t){var n,r,a,o,s=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2&&void 0!==s[2]?s[2]:{},a=n?"?"+Object.keys(n).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent("object"===typeof n[e]?JSON.stringify(n[e]):n[e])})).join("&"):"",o="".concat(t).concat(a),e.next=5,new Promise((function(e,t){fetch(o,O({method:"GET"},r)).then((function(e){return e.json()})).then((function(t){return e(t)})).catch((function(t){return e({error:{code:-1,text:t.toString()}})}))}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return new Promise((function(t){return setTimeout(t,e)}))}function D(){var e=window.location.search.length>0&&JSON.parse('{"'+decodeURI(window.location.search.substring(1)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');return e&&e.vk_chat_id&&(e.vk_chat_id=decodeURIComponent(e.vk_chat_id)),e}function S(){return"desktop_web"===D().vk_platform}function C(e){var t=document.createElement("a");t.href=e,t.target="_blank",t.click(),t.remove()}var F=n(38),A=n.n(F);var I=4,U=2,T=3,W="https://vds2153919.my-ihor.ru:8081/api/",M=W+"apps.get",V=0;function J(){return{2:{2:{0:23,1:24},1:{2:23,3:24}},3:{2:{0:23,1:29,2:30},1:{3:23,4:29,5:30}},4:{2:{0:16,1:20,2:29,3:30},1:{4:16,5:20,6:29,7:30}}}[I]}function K(e,t){var n=J();if(0===e||0===t)return V;for(var r=n[e],a=Object.keys(r).map((function(e){return[e,r[e]]})),o=0;o<a.length;o++){var s=a[o];if(o===a.length-1)return parseInt(s[0]);if(parseInt(t)<=parseInt(s[1]))return parseInt(s[0])}return V}function z(){return G.apply(this,arguments)}function G(){return(G=Object(v.a)(g.a.mark((function e(){var t,n,r,a,o,s,i,c,u,p,l,f,h,b,m,v,_,y,k,x,w,O,E,P,S;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=parseInt(D().vk_app_id||0),e.next=3,j(M,{app_id:t});case 3:for((n=e.sent.response)||(n={app_id:t,group_id_join:new Array(I*T*2).fill(1),group_id_message:new Array(I*U*2).fill(1),save_photo_album:!1,need_panel_upload_photo:!1,tg_urls:[],is_show_tg:!1,categories_for_tg:[],category_group_default:0,album_name:"\ud83e\udd2a",album_caption:"\u0423\u0437\u043d\u0430\u0439 \u043a\u0430\u043a \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u044b\u0435 \u0441\u0442\u0438\u043a\u0435\u0440\u044b - vk.com/app51535584#mark",need_upload_default_album_photo:!1,album_default_photo_url:"https://i.ibb.co/vDCcZsf/photo-2023-01-27-14-38-48.jpg"}),r=[],a=[],s=(o=n).category_group_default,i=o.is_show_tg,c=o.categories_for_tg,u=o.need_panel_upload_photo,p=o.need_upload_default_album_photo,l=o.album_default_photo_url,f=o.group_id_join,h=o.group_id_message,b=o.save_photo_album,m=o.tg_urls,V=s,v=0;v<f.length;v+=T)r.push(f.slice(v,v+T));for(_=0;_<h.length;_+=U)a.push(h.slice(_,_+U));return e.next=11,d.a.send("VKWebAppGetUserInfo");case 11:return y=e.sent,k=y.sex,x=y.bdate,w=x&&3===x.split(".").length?(new Date).getFullYear()-parseInt(y.bdate.split(".")[2]):0,O=K(k,w),E=r[O],P=a[O],S={groupsJoinCategory:r,groupsJoinUser:E,groupsMessageCategory:a,groupsMessageUser:P,vk_user:y,app:n,showGroupsCategory:O,savePhotoAlbum:b,need_upload_default_album_photo:p,album_default_photo_url:l,is_show_tg:i,categories_for_tg:c,need_panel_upload_photo:u,need_panel_sex_years:0===k||0===w,tg_urls:m,sex:k,years:w},console.debug(S),e.abrupt("return",S);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;d.a.subscribe(function(){var n=Object(v.a)(g.a.mark((function n(r){var a,o,s,i,c;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=r.detail,o=a.type,s=a.data,void 0!==o&&console.debug(o,s),"VKWebAppUpdateConfig"===o?(i=document.createAttribute("scheme"),c=s.scheme?"client_light"===s.scheme?"bright_light":s.scheme:"bright_light",i.value=t||c,document.body.attributes.setNamedItem(i),e[o]&&"function"===typeof e[o]&&e[o]()):e[o]&&"function"===typeof e[o]&&e[o]();case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}var N=n(314),R=n(315),B=n(316);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(n,!0).forEach((function(t){Object(b.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q="https://cloud-api.yandex.net/v1/disk/public/resources?public_key=",Y={margin:"14px 21px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px 12px",paddingBottom:48},q={background:"#E64646",color:"#FFFFFF",cursor:"pointer",height:48,borderRadius:16,display:"flex",alignItems:"center",justifyContent:"center",gap:8.5,fontFamily:"SF Pro Text",fontWeight:600,fontSize:"17px",lineHeight:"22px"},X={marginTop:8,paddingBottom:8,color:"#818C99",fontFamily:"SF Pro Text",fontWeight:400,fontSize:"15px",lineHeight:"18px",textAlign:"center"},$=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(s.a)(t).call(this,e))).state={},k.bind(Object(_.a)(n))(),n.checkHash=n.checkHash.bind(Object(_.a)(n)),n.fetchDataFromDisk=n.fetchDataFromDisk.bind(Object(_.a)(n)),n.fetchDataFromDiskFolder=n.fetchDataFromDiskFolder.bind(Object(_.a)(n)),n}return Object(i.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){var e=Object(v.a)(g.a.mark((function e(){var t,n,r,a,o,s,i,c,u=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchDataFromDisk();case 2:return this.checkHash(),H({VKWebAppChangeFragment:function(){return u.checkHash()}},"bright_light"),e.next=6,z();case 6:t=e.sent,this.setState(t),n={},r=0,a=["groupsJoinUser","groupsMessageUser"];case 11:if(!(r<a.length)){e.next=36;break}o=a[r],n[o]=[],s=t[o],i=0;case 16:if(!(i<s.length)){e.next=33;break}return e.prev=17,e.next=20,d.a.send("VKWebAppGetGroupInfo",{group_id:s[i]});case 20:c=e.sent,n[o].push(c),e.next=30;break;case 24:return e.prev=24,e.t0=e.catch(17),console.error(e.t0),i--,e.next=30,P(1e3);case 30:i++,e.next=16;break;case 33:r++,e.next=11;break;case 36:this.setState(n),d.a.send("VKWebAppInit");case 38:case"end":return e.stop()}}),e,this,[[17,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){}},{key:"checkHash",value:function(){var e=window.location.hash;return e.startsWith("#")&&this.fetchDataFromDiskFolder(e.substring(1)),!1}},{key:"fetchDataFromDisk",value:function(){var e=Object(v.a)(g.a.mark((function e(){var t,n,r,a,o,s,i,c,u;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A()(Q+"https://disk.yandex.ru/d/VN10ZCxJTs3NPQ");case 2:return e.next=4,e.sent.json();case 4:for(t=e.sent,n=t._embedded.items,r=[],a=!0,o=!1,s=void 0,e.prev=10,i=n[Symbol.iterator]();!(a=(c=i.next()).done);a=!0)"dir"===(u=c.value).type&&u.public_url&&r.push({name:u.name,url:u.public_url});e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),o=!0,s=e.t0;case 18:e.prev=18,e.prev=19,a||null==i.return||i.return();case 21:if(e.prev=21,!o){e.next=24;break}throw s;case 24:return e.finish(21);case 25:return e.finish(18);case 26:return console.log({folders:r}),e.next=29,this.setState({folders:r});case 29:case"end":return e.stop()}}),e,this,[[10,14,18,26],[19,,21,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"fetchDataFromDiskFolder",value:function(){var e=Object(v.a)(g.a.mark((function e(){var t,n,r,a,o,s,i,c,u,p,l,f,h=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:"",n=this.state.folders.find((function(e){return e.name===t}))){e.next=4;break}return e.abrupt("return",n);case 4:return e.next=6,A()(Q+n.url);case 6:return e.next=8,e.sent.json();case 8:for(r=e.sent,a=r._embedded.items,o=[],i=!0,c=!1,u=void 0,e.prev=14,p=a[Symbol.iterator]();!(i=(l=p.next()).done);i=!0)"file"===(f=l.value).type&&f.preview?o.push(f.preview):f.name.includes("zip")&&(s=f.file);e.next=22;break;case 18:e.prev=18,e.t0=e.catch(14),c=!0,u=e.t0;case 22:e.prev=22,e.prev=23,i||null==p.return||p.return();case 25:if(e.prev=25,!c){e.next=28;break}throw u;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return console.log({folder:t,stickers_img:o,stickers_zip:s}),e.next=33,this.setState({folder:t,stickers_name:t.split("_").map((function(e){return e[0].toUpperCase()+e.substring(1)})).join(" "),stickers_img:o,stickers_zip:s});case 33:case"end":return e.stop()}}),e,this,[[14,18,22,30],[23,,25,29]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.activeModal,r=t.stickers_name,a=t.stickers_img,o=t.stickers_zip,s=t.folder,i=t.groupsJoinUser,c=t.groupsMessageUser;return u.a.createElement(f.l,Object.assign({},x.bind(this)(),{modal:u.a.createElement(f.h,{activeModal:n},u.a.createElement(f.g,{id:"get",onClose:function(){e.setActiveModal(null)}},u.a.createElement("div",{style:X},"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0442\u0435 \u043d\u0430\u0448\u0438\u0445 \u0430\u0432\u0442\u043e\u0440\u043e\u0432 \u0438 ",u.a.createElement("span",{style:{color:"var(--text_primary)"}},"\u043f\u043e\u0434\u043f\u0438\u0448\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0433\u0440\u0443\u043f\u043f\u044b"),", \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430"),i&&i.map((function(e,t){return u.a.createElement(f.k,{key:"Cell-".concat(t),before:u.a.createElement(f.d,{size:48,src:e.photo_50}),after:u.a.createElement(N.a,null),onClick:function(){return d.a.send("VKWebAppJoinGroup",{group_id:e.id})}},e.name)})),c&&c.map((function(e,t){return u.a.createElement(f.k,{key:"Cell-".concat(t),before:u.a.createElement(f.d,{size:48,src:e.photo_50}),after:u.a.createElement(R.a,null),onClick:function(){return d.a.send("VKWebAppAllowMessagesFromGroup",{group_id:e.id})}},e.name)})),u.a.createElement("div",{style:Z({},q,{marginTop:20}),onClick:Object(v.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S()){e.next=4;break}C(o),e.next=13;break;case 4:return e.prev=4,e.next=7,d.a.send("VKWebAppDownloadFile",{url:o,filename:"".concat(s,".zip")});case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(4),console.error(e.t0),C(o);case 13:case"end":return e.stop()}}),e,null,[[4,9]])})))},u.a.createElement(B.a,null)," \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c")))}),u.a.createElement(f.i,{id:"main"},u.a.createElement(f.j,null,r),u.a.createElement("div",{style:Y},a&&a.map((function(e,t){return u.a.createElement("img",{alt:"sticker",key:"img-".concat(t),src:e,style:{justifySelf:"center"}})}))),u.a.createElement("div",{style:Z({},q,{position:"fixed",bottom:"calc(var(--safe-area-inset-bottom) + 8px)",left:16,right:16}),onClick:Object(v.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setActiveModal("get");case 1:case"end":return t.stop()}}),t)})))},u.a.createElement(B.a,null)," \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043d\u0430\u0431\u043e\u0440")))}}]),t}(u.a.Component),ee=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(s.a)(t).call(this,e))).state={},n}return Object(i.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){var e=this;d.a.subscribe((function(t){var n=t.detail,r=n.type,a=n.data;"VKWebAppUpdateConfig"===r&&e.setState({appearance:a.appearance})}))}},{key:"render",value:function(){return u.a.createElement(f.e,{webviewType:f.m.INTERNAL,appearance:this.state.appearance},u.a.createElement(f.a,null,u.a.createElement(f.c,null,u.a.createElement($,null))))}}]),t}(u.a.Component);l.a.render(u.a.createElement(ee,null),document.getElementById("root"))}},[[196,1,2]]]);
//# sourceMappingURL=main.3fb60f0c.chunk.js.map